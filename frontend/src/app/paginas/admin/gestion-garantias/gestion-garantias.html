<div class="container">
  <h2 class="titulo">Gestión Completa de Garantías</h2>

  <!-- GARANTÍA ACTUAL QUE PAGA EL CLIENTE -->
  <div class="card-principal">
    <h3>Garantía que paga el cliente</h3>
    <div class="valor-grande">
      <strong>{{ garantiaPrincipal?.porcentaje || 50 }}%</strong>
    </div>
    <p>Este es el porcentaje que el cliente debe pagar al hacer un pedido personalizado</p>
  </div>

  <!-- LISTA DE OPCIONES -->
  <div class="opciones-grid">
    <button class="btn-nuevo" (click)="abrirModal()">+ Nueva Opción</button>

    <div *ngFor="let opcion of opciones" class="opcion-card"
         [class.principal]="opcion.esPrincipal"
         [class.inactiva]="!opcion.activo">

      <div class="header">
        <span class="porcentaje">{{ opcion.porcentaje }}%</span>
        <span class="badge" [class.principal]="opcion.esPrincipal">
          {{ opcion.esPrincipal ? 'PRINCIPAL' : (opcion.activo ? 'ACTIVA' : 'INACTIVA') }}
        </span>
      </div>

      <p class="descripcion">{{ opcion.descripcion || 'Sin descripción' }}</p>

      <div class="acciones">
        <button class="btn-principal" (click)="establecerPrincipal(opcion)"
                *ngIf="!opcion.esPrincipal">
          Hacer Principal
        </button>
        <button class="btn-edit" (click)="abrirModal(opcion)">Editar</button>
        <button class="btn-toggle" (click)="toggleActivo(opcion)">
          {{ opcion.activo ? 'Desactivar' : 'Activar' }}
        </button>
      </div>
    </div>
  </div>

  <div class="modal-directo" *ngIf="modalVisible" (click)="cerrarModal()">
  <div class="modal-content-directo" (click)="$event.stopPropagation()">
    <div class="modal-header">
      {{ esEdicion ? 'Editar Opción' : 'Nueva Opción de Garantía' }}
    </div>
    
    <div class="modal-body">
      <div class="form-group">
        <label>Porcentaje (%)</label>
        <input type="number" [(ngModel)]="form.porcentaje" min="1" max="100">
      </div>
      
      <div class="form-group">
        <label>Descripción (opcional)</label>
        <input type="text" [(ngModel)]="form.descripcion">
      </div>

      <div class="botones">
        <button class="btn-cancel" (click)="cerrarModal()">Cancelar</button>
        <button class="btn-guardar" (click)="guardar()">
          {{ esEdicion ? 'Actualizar' : 'Crear' }}
        </button>
      </div>
    </div>
  </div>
</div>